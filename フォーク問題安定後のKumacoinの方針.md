フォーク問題安定後のKumacoinの方針
====
KumacoinはCoindに入り込んだバグにより大規模フォークしました。2018/5現在では、原因と思われるバグは修正されCoindの更新が進みフォークは収まり安定していると考えられます。しかし、バグ修正の過程でコードの品質に疑問が生じ、フォークが収束したのか疑問が残り終息宣言を出せない状況です。そこで今後の方針についていくつか提案しますので選択をお願いします。

経緯
----
1. 2019/2/3 フォークの主原因は2月初めに取り込まれた[FakeStakeAttack](https://medium.com/@dsl_uiuc/fake-stake-attacks-on-chain-based-proof-of-stake-cryptocurrencies-b8b05723f806)の対策です。移植元のPIVXのFakeStake対策は、同一Inputかつ同一ブロック高で複数回Stakeされると誤判定します。これによりフォーク時に他のチェーンに移動できなくなり、フォークより復帰できなくなりました。これに加えネットワーク上にマイナーが分散するPoSの性質により、フォーク先で採掘を行う未更新のユーザーが多数出現しフォーク問題が深刻になりました。
2. 2019/3/29 ブロック高2439896にて初めてフォークが発生しました。
4. 2019/4/10 当初は原因がわからず急激なハッシュ投入によるものなのか？と疑問に思いつつもCheckPointを追加する事で解決を図りました。しかしフォーク先でフォークを起こすという事態に発展しました。その為、Kumacoinを扱うインフラ各所に停止を要請し、現在まで停止が継続しています。
5. 2019/4/13 フォークの原因が上記のバグが判明しBountyにより修正を公募し、修正パッチが公開されました。バグ修正の見込みが立ったため、安定化を図りKumacoinが唯一上場しているNovaの存在するチェーンを正当としました。
6. 2019/4/14 パッチ修正者の提案により**ノードの安定するチェーンを正当**とすることに方針を変更しました。
7. 2019/4/17 フォーク問題は収束する気配がありませんでした。原因として挙げられるのは以下ですが、5月現在では1,3,4が解決済みです。
    1. KumacoinはPoSでありマイナーが広範囲に分散している
    2. 最大採掘プールのLApoolの管理人と連絡がとれずCoindの更新を促せなかった
    3. 利用者の大半が使用するWindowsQtバイナリをビルドできなかった
    4. KumacoinのGithubアカウントが使用停止されており広報できなかった
    5. 先導している人がC++を書けない（Kumacoinの活動家で導ける存在がいない
8. 2019/4/19 C++が書けない為に流されるまま方針転換を繰り返すことになりKumacoinのコミュニティは混乱しました。そこで基本に立ち戻り採掘力で未更新クライアントに引っ張られていると仮定し、Reorgの制限を大幅に緩和しマイナーの更新を促す事で収束しようと考えました。連絡が取れるPoolに声をかけCoindの更新に注意を払ってもらい、またそのPoolに属するチェーンにユーザーが接続できるようポート開放しているクライアントを増やす事に方針を転換しました。
9. 2019/5/16 おそらく安定したと思われますが確定していません。

前提
----
* 実はKumacoinのソースの品質は低いです。薄々勘付いていましたが今回のバグで指摘され明確になり、何かしらの対策をとる必要があります。
* Kumacoinの由来は`Peercoin -> Novacoin -> Mintcoin -> Probe -> Kumacoin`と秘伝のタレを継ぎ足すかのようにフォークを繰り返しています。これは参考です。
* C++をいじれる人でKumacoinにCommitする人がいない。コード書けないとコインはコントロール不能に陥ります。また他からの支援は無いものねだりになります。
* Kumacoinに限りませんが大抵はBTCの子孫です。そのため仕様がBTCに引きずられFakeStakeAttackのようなバグを生み出します。
* Kumacoinのblockchainに致命的ではないが修正不可能なバグが混入しています。送受金に影響はないが他に隠れているバグがあるのではないかと不安感を抱かせます。
* CryptopiaのGOXによりBountyの資金が厳しくなりました。これまでの様にバグに対してBountyを設置する事が難しくなるのでコーディング力不足をカバーできなくなる可能性があります。これも他からの支援は無いものねだりになります。

方針
----
方針として３つが挙げられます。各々利点欠点があるのでどれがいいか確認しておいてください。

### 1. 現在のソースコードに修正を施し続ける
* 利点
    * 過去の変更履歴をそのまま残すことができる
    * チェーンの変更なし
    * 作業量が最小
* 欠点
    * 常駐メンテナーがいないので保守性に欠ける
    * C++のメンテナーがkumacoinに少ない
    * チェーンに含まれたバグを引き継ぐ

### 2. 整備されているコインのソースに乗り換える
* 利点
    * 少なくともメンテナーが少ないkumacoinより品質は保証される
    * チェーンの変更なし
* 欠点
    * 過去の履歴を引き継げない
    * C++のメンテナーがkumacoinに少ない
    * 採用したコインに潜むバグを掘り当てる可能性がある
    * 移植作業を行う人が必要となり作業が多い
    * チェーンに含まれたバグを引き継ぐ

### 3. 異なるベースのコインに乗り換える
既に[テストネットが稼働している](https://hackmd.io/s/SJwtbBpI4)ので実際に操作してみるのがいいと思います。
* 利点
    * Python3で書かれているので現状のコードより保守性が高い
    * PythonとRustのハイブリットにより効率良く開発ができる
    * 現状のコードより機能が豊富
    * 少なくともNamuyanがメンテナーとして継続できる
    * BTCの仕様を引きずらない設計がされている
    * 暗号に同じ楕円を用いているのでSwap後にユーザーの残高を復旧できる
* 欠点
    * チェーンの変更が必須
    * 各所の対応ができない場合は本方針は無効(別の方針を考えます)
    * kumacoinでPython3を扱える人がどれだけいるかは未知数
    * まだGUI開発が不十分
    * クライアント付属Walletの機能が不十分

補足
----
* [**異なるベースのコイン**](https://pycontract.tk)とは、一年以上前から作成していたものの国産通貨のはびこりで公開しづらくなり陰で趣味として開発していました。自分の思うとおりに作成したので多機能ですが、コントラクトはかなりゲテモノなので廃止するかもしれないです。一から設計と作成を行ったのと実験環境が不十分なのでコード品質に疑問が残ります。
* **他からの支援は無いものねだり**とは、OSSだからといってパッチがどこからともなく飛んでくることは無いし、運営がプリマインをしてないからといってどこからともなく資金が飛んでくる事はないです。
* **フォーク**について、KumacoinはOSSであり、有名無名さまざまな開発者がコードをCommitする事で作り上げていくものであり、また多くの目にさらすことで不正をだけでなくバグや仕様ミスを防ぐことを期待しています。残念な事にKumacoinは有名でないので目が乏しく今回のような残念な事になってしまいました。
* このページの内容を引用する場合、URLと題名の引用明示をお願いします。

blockchainに致命的ではないが修正不可能なバグ とは
----
Kumacoinは送金をBlockchainに記録する際に100倍された数値を記録しています。これはRingoやNeetcoinのクライアントが手元にあれば簡単に検証する事が出来ます、先ほどの２つのコインはKumaと同じCtransactionを使用しますので互いにTXをエンコード・デコードできます。下記のkumacoindをringodに変更して実行してみて下さい。これはBlockchainに記録されるので修正不可能なバグになります。
```bash=
kumacoind decoderawtransaction 010000005b67dd5c01d87fa7b8912d8e274d4dbf9d23dabc8bab9982bf4a88f7fed949d0901993b55e010000004a493046022100978dba5442aea2d451e7b5f2dfd66d6f8a99281ed210834bc89fc492eb1e382c022100d0de7f4bb594db7042dae20e0dd1cd7ad75025ecf661eaa25c009008b8e045a401ffffffff03000000000000000000b0709edf01000000232103fb5c0fa6d8fc31ee7ea9bf6fa2bba7fdae1afb41b7f2b821562f2ec798f8fcacace88a9edf01000000232103fb5c0fa6d8fc31ee7ea9bf6fa2bba7fdae1afb41b7f2b821562f2ec798f8fcacac00000000
```

履歴
----
2019/5/17 選択肢のメリットデメリットについて変更、バグについて説明追加
2019/5/16 初筆
